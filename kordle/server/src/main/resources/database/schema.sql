CREATE TABLE IF NOT EXISTS
    OPPGAVE (
        ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        ORD VARCHAR(16) UNIQUE,
        LENGDE INT GENERATED ALWAYS AS LENGTH(ORD)
     );

CREATE INDEX IF NOT EXISTS
    idx_oppgave_ord
ON OPPGAVE (ORD);

CREATE TABLE IF NOT EXISTS
    KordleUser (
        Id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        Username VARCHAR(32) UNIQUE NOT NULL
    );

CREATE INDEX IF NOT EXISTS
    idx_user_username
ON KordleUser (Username);

CREATE TABLE IF NOT EXISTS
    UserOppgaveResult (
        UserId BIGINT NOT NULL,
        OppgaveId BIGINT NOT NULL,
        Success BOOLEAN NOT NULL,
        AttemptCount INT NOT NULL,

        PRIMARY KEY (UserId, OppgaveId),
        FOREIGN KEY (UserId) REFERENCES KordleUser(Id) ON DELETE CASCADE,
        FOREIGN KEY (OppgaveId) REFERENCES OPPGAVE(ID) ON DELETE CASCADE
    );
